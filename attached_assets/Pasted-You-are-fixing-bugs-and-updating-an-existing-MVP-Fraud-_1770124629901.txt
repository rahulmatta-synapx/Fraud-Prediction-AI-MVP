You are fixing bugs and updating an existing MVP Fraud Prediction AI Agent project (React frontend + Azure Functions Python/FastAPI backend).

Current issues:
- When uploading a document on Submit New Claim → "Extraction Warning: Error code: 400 - {'error': {'code': 'BadRequest', 'message': 'Invalid image URL. The URL must be a valid HTTP or HTTPS URL, or a data URL with base64 encoding.', 'param': None, 'type': None}}"
  → This happens because the file_data in Responses API is not correctly formatted as "data:application/pdf;base64,{base64_string}".

- Fix must use EXACTLY this code pattern for extraction (copy-paste style):
```python
import base64
import os
from openai import OpenAI
 
client = OpenAI(  
  base_url=os.getenv("AZURE_OPENAI_ENDPOINT") + "/openai/v1/",  # use secret
  api_key=os.getenv("AZURE_OPENAI_KEY")  
)
 
# Example with file bytes
base64_string = base64.b64encode(file_bytes).decode("utf-8")
 
response = client.responses.create(
    model="gpt-4.1",  # EXACT deployment name — change all gpt-4o references to gpt-4.1
    input=[
        {
            "role": "user",
            "content": [
                {
                    "type": "input_file",
                    "filename": "uploaded_claim.pdf",
                    "file_data": f"data:application/pdf;base64,{base64_string}",
                },
                {
                    "type": "input_text",
                    "text": "Extract all the following fields from this UK motor insurance claim document accurately. Return only JSON with these exact keys: claimant_name, policy_id, num_previous_claims, total_previous_claims_gbp, vehicle_make, vehicle_model, vehicle_year, vehicle_registration, vehicle_estimated_value_gbp, accident_date (YYYY-MM-DD), accident_type (one of: Collision, Rear-End, Side Impact, Rollover, Hit and Run, Parking Damage, Theft, Vandalism, Fire, Flood Damage), accident_location, claim_amount_gbp, accident_description. If missing or unclear, use null. Be neutral and factual.",
                },
            ],
        },
    ]
)
 
extracted_json = json.loads(response.output_text)

Change EVERY occurrence of "gpt-4o" or "gpt-4o-mini" in the entire project to "gpt-4.1" (exact deployment name).
Keep single file upload only (no multiple) + add Remove button + error if second upload attempted ("Sorry, only one document per claim entry is allowed").
Use secrets: AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_KEY, COSMOS_CONNECTION_STRING, AZURE_STORAGE_CONNECTION_STRING.
Fix any Cosmos connection parsing issues from previous logs (strip whitespace, validate format).

Tasks:

Update backend/ai_service.py or wherever extraction happens:
Read uploaded file bytes
Encode to base64
Build "data:application/pdf;base64,{base64_string}"
Use client.responses.create exactly as shown above
Parse output_text as JSON → return to frontend

Frontend (SubmitClaim.tsx):
Restrict input type="file" to single file (multiple=false)
State for single file + preview
Remove button clears file state
On second upload attempt → show toast/alert error message

Replace all model names: search project for "gpt-4o" → replace with "gpt-4.1"
Test instructions:
Login as navsheen
Go to Submit New Claim
Upload one PDF → see auto-fill
Try upload second → see "Sorry, only one..." message
Click Remove → clear preview
Submit → see logs in audit


Output:

Updated code blocks for:
backend/services/ai_service.py (or extraction function)
frontend/src/pages/SubmitClaim.tsx (upload + remove + error)

Any other changed files
How to verify the fix (upload sample PDF, check no 400 error, see extracted fields)

Generate the fixes now — make it work with the exact Responses API pattern shown.